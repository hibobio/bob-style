@import '../../style/common-imports';
@import '../../style/icons.mixin';

$brdcrb-height: base8(64);
$vertical-brdcrb-height: 74px;
$vertical-brdcrb-line-length: 42px;
$brdcrb-circle-size: 18px;

@mixin hide-tooltip {
  &:before,
  &:after {
    display: none;
  }
}

:host {
  display: flex;
  justify-content: space-between;
  align-items: center;
  user-select: none;
  text-align: left;

  &[data-type='primary'],
  &[data-type='secondary'] {
    height: $brdcrb-height;
  }
}

.steps {
  list-style: none;
  display: flex;
  margin: 0;
  padding: 0;
}

.step,
.step-wrap {
  display: flex;
  align-items: center;
}

[data-tooltip]:after {
  min-width: 100px;
}

.step-wrap {
  @include mobile {
    @include hide-tooltip;
  }
}

.step-index {
  @include text-hide;
  @include size($brdcrb-circle-size);
  flex-shrink: 0;
  border-radius: 50%;
  @include flex-align;
}

.step-title {
  font-size: $font-size-body;
  line-height: 1.3;
  margin-left: times8(1);
}

[data-state='open'] ::ng-deep,
[data-state='warning'] ::ng-deep,
[data-state='success'] ::ng-deep {
  .step-index {
    cursor: pointer;
  }
}

.step-index {
  cursor: default;
}

[data-state='closed'] ::ng-deep {
  .step-index {
    background-color: $grey-500;
  }

  .step-title {
    color: $grey-600;
  }
}

[data-state='open'] ::ng-deep {
  .step-index {
    border: 4px solid var(--negative-500);
  }
}

[data-state='active'] ::ng-deep {
  .step-wrap {
    @include hide-tooltip;
  }

  .step-index {
    background-color: var(--negative-500);
  }

  .step-title {
    font-weight: 700;
  }
}

[data-state='warning'] ::ng-deep {
  .step-index {
    @include b-icon(
      $icon: error,
      $size: null,
      $color: $color-warn,
      $hover: false
    ) {
      font-size: 21px;
      line-height: $brdcrb-circle-size;
      overflow: visible;
    }
    box-shadow: inset 0 0 0 1px $color-warn;
  }
}

[data-state='success'] ::ng-deep {
  .step-index {
    @include b-icon(
      $icon: success-alt,
      $size: null,
      $color: $negative-500,
      $hover: false
    ) {
      font-size: 21px;
      line-height: $brdcrb-circle-size;
      overflow: visible;
    }
    box-shadow: inset 0 0 0 1px $negative-500;
  }
}

// Primary & Secondary

@mixin circle-view-common {
  .step {
    margin-right: times8(1);
  }

  .step-title {
    @include text-hide;
    margin: 0;
  }

  .step-index {
    @include size(6px);
    background-color: $grey-500;
    box-shadow: none;

    &:before {
      display: none;
    }
  }

  [data-state='active'] {
    .step-index {
      border: 0;
      @include size(times8(1));
      background-color: var(--negative-500);
    }
  }
}

// Primary

:host[data-type='primary']::ng-deep {
  .steps {
    align-items: center;
  }

  .step {
    @include desktop {
      @include b-icon(
        $icon: chevron-right,
        $size: medium,
        $color: normal,
        $elem: '&:after',
        $hover: false
      ) {
        margin: 0 times8(1);
      }

      &:last-child:after {
        display: none;
      }
    }
  }

  @include mobile {
    @include circle-view-common;
  }
}

:host[data-type='primary'][data-always-show-title='false']::ng-deep {
  .step:not([data-state='active']) {
    .step-title {
      @include text-hide;
      margin: 0;
    }
  }
}

// Secondary

:host[data-type='secondary'] ::ng-deep {
  @include circle-view-common;

  .steps {
    align-items: center;
  }

  @include desktop {
    position: relative;
    justify-content: flex-end;

    .steps {
      @include size(100%);
      @include position;
      z-index: 0;
      justify-content: center;
    }
  }
}

// Vertical

:host[data-type='vertical'] ::ng-deep {
  .steps {
    width: $sidebar-width;
    flex-direction: column;
  }

  .step {
    height: $vertical-brdcrb-height;
    position: relative;

    &:after {
      @include pseudo;
      @include size(2px, $vertical-brdcrb-line-length);
      position: absolute;
      left: $brdcrb-circle-size / 2 - 1px;
      bottom: -1 * $vertical-brdcrb-line-length / 2;
      background-color: $grey-500;
    }

    &:last-child:after {
      display: none;
    }
  }

  .step-title {
    font-size: $font-size-big-body;
  }

  [data-state='closed'] {
    .step-index {
      padding: 4px;
      background-color: transparent;

      &:before {
        flex-shrink: 0;
        @include pseudo;
        @include size(12px);
        border-radius: 50%;
        background-color: $grey-500;
      }
    }
  }
}
