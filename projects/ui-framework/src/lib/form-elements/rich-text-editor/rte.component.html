<label *ngIf="label && placeholder"
       class="bfe-label"
       [attr.for]="id">{{label}}</label>

<div class="quill-editor"
     [attr.id]="id">
  <div #quillEditor
       [attr.data-length]="hasSuffix && (minChars > 0 || maxChars) ? ( (length || 0) + (maxChars ? '/' + maxChars : '')) :
       null"
       (keydown)="$event.stopPropagation()"
       [ngClass]="{'length-invalid': hasSuffix && (length < minChars
         || (maxChars && length > maxChars))}"
       [ngStyle]="{
         minHeight: minHeight ? (minHeight - 43) + 'px' : null,
         maxHeight: maxHeight ? (maxHeight - 43) + 'px' : null
        }">
  </div>

  <div #toolbar
       class="quill-toolbar"
       [hidden]="controls.length === 0 && !hasSuffix"
       (mousedown)="$event.preventDefault()">

    <b-panel #sizePanel
             panelClass="rte-size-controls"
             [showBackdrop]="false"
             [size]="panelSize.medium"
             *ngIf="controls.includes(BlotType.size)"
             [defaultPosVer]="panelDefaultPosVer.below"
             (closed)="restoreSelection()">
      <button type="button"
              class="rte-size"
              panel-trigger
              [ngClass]="{'ql-active': hasSizeSet}"
              (click)="storeSelection()">

        <b-icon icon="text_size_option"
                size="medium"
                color="normal">
        </b-icon>
      </button>
      <ng-container panel-content>
        <button type="button"
                class="rte-button rte-size-small"
                (click)="changeFontSize(RTEFontSize.small)">Small</button>
        <button type="button"
                class="rte-button rte-size-normal"
                (click)="changeFontSize(RTEFontSize.normal)">Normal</button>
        <button type="button"
                class="rte-button rte-size-large"
                (click)="changeFontSize(RTEFontSize.large)">Large</button>
        <button type="button"
                class="rte-button rte-size-huge"
                (click)="changeFontSize(RTEFontSize.huge)">Huge</button>
      </ng-container>
    </b-panel>

    <button class="ql-bold"
            [hidden]="!controls.includes(BlotType.bold)"></button>
    <button class="ql-italic"
            [hidden]="!controls.includes(BlotType.italic)"></button>
    <button class="ql-underline"
            [hidden]="!controls.includes(BlotType.underline)"></button>

    <b-panel #linkPanel
             panelClass="rte-link-editor-panel"
             [showBackdrop]="false"
             [size]="panelSize.medium"
             [hidden]="!controls.includes(BlotType.link)"
             [defaultPosVer]="panelDefaultPosVer.below"
             (closed)="restoreSelection()">
      <button class="ql-link"
              panel-trigger></button>
      <b-rte-link-editor #linkEditor
                         panel-content
                         (linkCancel)="linkPanel.closePanel();"
                         (linkUpdate)="onLinkUpdate($event)">
      </b-rte-link-editor>
    </b-panel>

    <button type="button"
            class="ql-list"
            value="ordered"
            [hidden]="!controls.includes(BlotType.list)"></button>
    <button type="button"
            class="ql-list"
            value="bullet"
            [hidden]="!controls.includes(BlotType.list)"></button>

    <select class="ql-align"
            [hidden]="!controls.includes(BlotType.align)">
      <option selected></option>
      <option value="center"></option>
      <option value="right"></option>
      <option value="justify"></option>
    </select>

    <button type="button"
            class="ql-direction"
            value="rtl"
            [hidden]="!controls.includes(BlotType.direction)"></button>

    <b-panel #placeholderPanel
             class="placeholder-panel"
             panelClass="placeholder-rte-panel"
             [showBackdrop]="false"
             [size]="panelSize.medium"
             *ngIf="controls.includes(BlotType.placeholder)"
             [defaultPosVer]="panelDefaultPosVer.below"
             (closed)="restoreSelection()">
      <button (click)="onPlaceholderPanelOpen()"
              panel-trigger>ðŸ’Š</button>
      <b-single-list #placeholderSelect
                     panel-content
                     class="single-list-select"
                     (selectChange)="onPlaceholderSelectChange(placeholderSelect)"
                     [showSingleGroupHeader]="true"
                     [options]="placeholderList">
      </b-single-list>
    </b-panel>

    <div #suffix
         *ngIf="hasSuffix"
         class="toolbar-suffix">
      <ng-content></ng-content>
    </div>

    <span class="length-indicator"
          *ngIf="!hasSuffix && (minChars > 0 || maxChars)"
          [ngClass]="{'length-invalid': length < minChars ||
            (maxChars && length > maxChars)}">
      {{ (length || 0) + (maxChars ? '/' + maxChars : '') }}
    </span>

  </div>

</div>

<p b-input-message
   *ngIf="
          hintMessage
          ||
          warnMessage
          ||
          errorMessage"
   [hintMessage]="hintMessage"
   [warnMessage]="warnMessage"
   [errorMessage]="errorMessage"
   [disabled]="disabled"></p>
