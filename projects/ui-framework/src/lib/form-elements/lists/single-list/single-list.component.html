<b-search *ngIf="shouldDisplaySearch"
          (searchChange)="searchChange($event)">
</b-search>

<div [ngStyle]="{height: listOptions && (getListHeight() + 'px'), maxHeight: maxHeight + 'px'}"
     [ngClass]="{'no-group-header': noGroupHeaders, 'show-none-option': showNoneOption}"
     class="v-scroll-wrapper">

  <div #headers
       class="headers"
       *ngIf="!noGroupHeaders">
    <div *ngFor="let header of listHeaders"
         class="headers-group">
      <div (click)="headerClick(header)"
           [ngClass]="{
           'clickable': options.length > 1,
           'collapsed': header.isCollapsed,
           'focus': focusOption?.isPlaceHolder && focusOption?.groupName === header.groupName
           }"
           class="option-select header">
        <span *ngIf="options.length > 1"
              class="chevron b-icon-medium"
              [ngClass]="{'b-icon-chevron-down': !header.isCollapsed, 'b-icon-chevron-right':
              header.isCollapsed}"></span>
        <span [innerHTML]="header.groupName | highlight: searchValue"></span>
      </div>
      <div [ngStyle]="{height: header.isCollapsed ? 0 : header.placeHolderSize + 'px'}"
           class="placeholder"></div>
    </div>
  </div>

  <cdk-virtual-scroll-viewport #vScroll
                               class="v-scroll"
                               [itemSize]="listElHeight"
                               maxBufferPx="{{8*listElHeight}}"
                               minBufferPx="{{8*listElHeight}}">

    <button *ngIf="showNoneOption"
            type="button"
            class="clear-selection"
            (click)="clear.emit()">
      — None —
    </button>

    <div class="options">
      <div (click)="optionClick(option)"
           *cdkVirtualFor="let option of listOptions"
           [ngClass]="{
           'header-placeholder': option.isPlaceHolder,
           'option': !option.isPlaceHolder,
           'selected': option.selected,
           'focus': option.id===focusOption?.id,
           'disabled': option.disabled,
           'single-group-option': options.length === 1
           }"
           class="option-select">

        <b-component-renderer *ngIf="option.prefixComponent"
                              class="comp-prefix"
                              [render]="option.prefixComponent"></b-component-renderer>

        <span class="option-value"
              data-max-lines='3'
              [innerHTML]="option.value | highlight: searchValue">
        </span>

      </div>
    </div>
  </cdk-virtual-scroll-viewport>

</div>

<b-list-footer [listActions]="listActions"
               [listActionsState]="listActionsState"
               (clear)="clear.emit()"
               (apply)="apply.emit()">
  <ng-content footerAction
              select="[footerAction],[footer]"></ng-content>
</b-list-footer>
