<b-search *ngIf="shouldDisplaySearch"
          (searchChange)="searchChange($event)">
</b-search>

<div [ngStyle]="{height: listOptions.length * listElHeight + 'px', maxHeight: maxHeight + 'px'}"
     [ngClass]="{'no-group-header': noGroupHeaders}"
     class="v-scroll-wrapper">

  <div #headers
       class="headers"
       *ngIf="!noGroupHeaders">
    <div *ngFor="let header of listHeaders"
         class="headers-group">
      <div [ngClass]="{
           'collapsed': header.isCollapsed,
           'focus': focusOption?.isPlaceHolder && focusOption?.groupName === header.groupName
           }"
           class="option-select header">
        <span (click)="toggleGroupCollapse(header)"
              class="header-collapse-trigger">
        </span>
        <div class="header-option">
          <span class="checkbox"
                role="checkbox"
                [attr.aria-checked]="header.selected"
                (click)="headerSelect(header)"></span>

          <span [innerHTML]="header.groupName | highlight: searchValue"></span>
        </div>
        <span class="chevron"></span>
      </div>
      <div [ngStyle]="{height: header.isCollapsed ? 0 : header.placeHolderSize + 'px'}"
           class="placeholder"></div>
    </div>
  </div>

  <cdk-virtual-scroll-viewport #vScroll
                               class="v-scroll"
                               [itemSize]="listElHeight"
                               maxBufferPx="{{8*listElHeight}}"
                               minBufferPx="{{8*listElHeight}}">
    <div class="options">
      <div (click)="optionClick(option)"
           *cdkVirtualFor="let option of listOptions"
           [ngClass]="{
            'header-placeholder': option.isPlaceHolder,
            'option': !option.isPlaceHolder,
            'focus': option.id===focusOption?.id
           }"
           class="option-select">
        <span class="checkbox"
              role="checkbox"
              [attr.aria-checked]="option.selected"></span>
        <b-list-option [option]="option"
                       [searchValue]="searchValue">
        </b-list-option>
      </div>
    </div>
  </cdk-virtual-scroll-viewport>

</div>

<b-list-footer [listActions]="listActions"
               (clear)="onClear()"
               (apply)="apply.emit()"
               (cancel)="cancel.emit()">
</b-list-footer>
