<div class="container">
  <div class="table">

    <table cdk-table #table [dataSource]="dataSource" matSort (matSortChange)="sorted($event)" [matSortActive]="activeSort?.name"
      [matSortDirection]="activeSort?.sortActive" cdkDropList (cdkDropListDropped)="drop($event)">

      <ng-container cdkColumnDef="select" [sticky]="stickyColumns >= 0">
        <th cdk-header-cell *cdkHeaderCellDef >
          <mat-checkbox (change)="onSelectMaster($event)" [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()">
          </mat-checkbox>
        </th>
        <td cdk-cell *cdkCellDef="let row">
          <mat-checkbox (click)="$event.stopPropagation()" (change)="onSelectRow($event, row)" [checked]="selection.isSelected(row)">
          </mat-checkbox>
        </td>
      </ng-container>

      <ng-container *ngFor="let column of columns; let i = index" [cdkColumnDef]="column.name" [sticky]="stickyColumns >= i + 1">
        <th cdk-header-cell *cdkHeaderCellDef mat-sort-header [disabled]="!column.isSort" >
          <div draggable="true">{{ column.displayName }} <button (click)="$event.stopPropagation(); removeColumnClicked(column)">X</button></div>
        </th>
        <td cdk-cell *cdkCellDef="let row" (click)="rowClicked(row)" (contextmenu)="rightClicked(row)">
          <span *ngIf="column.type!=='component'">{{getColumnName(row, column.name)}}</span>
          <span *ngIf="column.type==='component'">
            <b-table-cell [row]="row" [column]="column" [data]="row[column.name]"></b-table-cell>
          </span>
        </td>
      </ng-container>

      <cdk-header-row *matHeaderRowDef="cols; sticky: stickyHeader"></cdk-header-row>
      <cdk-row *matRowDef="let row; columns: cols;" ></cdk-row>
    </table>

  </div>
</div>
